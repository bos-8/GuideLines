---
topic:      "light vs code msvc for c/cpp"
creation:   2025-02-24
author:     "BO$ <https://github.com/bos-8>"
tag:        [guide, config, msvc]
---
# C++ Development Setup in Visual Studio and VS Code

## Step 1: Install the Original Visual Studio
Download and install the official **Visual Studio** from [Microsoft's Visual Studio website](https://visualstudio.microsoft.com).

## Step 2: Install "Desktop Development with C++" in Visual Studio Installer
During the installation process, make sure to select **"Desktop development with C++"** to enable C++ development tools.

## Step 3: Install C/C++ Extension Pack in VS Code
Open **VS Code** and install the **C/C++ Extension Pack** from the **Extensions Marketplace**.

## Step 4: Verify if `cl.exe` is Installed Correctly
1. Open **x64 Native Tools Command Prompt for VS 2022**.
2. Type the following command:
   ```sh
   cl
   ```
3. The expected output should look like this:
   ```
   Microsoft (R) C/C++ Optimizing Compiler Version 19.43.34808 for x64
   Copyright (C) Microsoft Corporation. All rights reserved.

   usage: cl [ option... ] filename... [/link linkoption... ]
   ```

If you see an error, **make sure Visual Studio is installed correctly and includes C++ build tools.**

## Step 5: Set Up a Folder for Your C/C++ Files
1. Create a folder where you will store your C/C++ projects.
2. Inside this folder, create a new batch file **`cpp_jump_starter.bat`** with the following content:

   ```bat
   @echo off
   @REM Author: BO$ <https://github.com/bos-8>

   @REM Get the directory of the script
   set "scriptDir=%~dp0"

   @REM Path to vcvars64.bat (adjust if using a different VS version)
   set "vsPath=C:\Program Files\Microsoft Visual Studio\2022\Enterprise\VC\Auxiliary\Build\vcvars64.bat"

   @REM Load Visual Studio development environment
   call "%vsPath%"

   cd /d "%scriptDir%"
   code .

   @REM pause
   ```

---

## Step 6: Run the Batch File
1. **Double-click** `cpp_jump_starter.bat` to execute it.
2. This will:
   - Set up the Visual Studio C++ environment.
   - Navigate to your project folder.
   - Open VS Code in the current directory.

---

## Step 7: Create a Simple C++ File
1. Inside the folder, create a new **C++ source file** (`main.cpp`) and add the following code:

   ```cpp
   #include <iostream>

   int main() {
       std::cout << "Hello, World!" << std::endl;
       return 0;
   }
   ```

2. Press **F5** to run it in VS Code.

## Step 8: Configure VS Code Build Task
1. Inside your **project folder**, create a new folder named **`.vscode`**.
2. Inside `.vscode`, create a new file **`tasks.json`**.
3. Add the following content:

   ```json
   {
       "version": "2.0.0",
       "tasks": [
           {
               "type": "cppbuild",
               "label": "C/C++: Compile Active File with cl.exe",
               "command": "cl.exe",
               "args": [
                   "/Zi",
                   "/EHsc",
                   "/nologo",
                   "/Fe${fileDirname}\\bin\\${fileBasenameNoExtension}.exe",
                   "${file}"
               ],
               "options": {
                   "cwd": "${fileDirname}"
               },
               "problemMatcher": [
                   "$msCompile"
               ],
               "group": {
                   "kind": "build",
                   "isDefault": true
               },
               "detail": "Task generated by the debugger."
           }
       ]
   }
   ```

4. This configuration:
   - Compiles the **active file** using `cl.exe`.
   - Stores the compiled **`.exe`** in the `bin/` folder inside your project.

## Step 9: Add a Task to Clean Unnecessary Files
Modify **`tasks.json`** to include a cleanup task that removes **unnecessary files** like `*.obj`, `*.exe`, `*.pdb`, and `*.ilk`.

### **Updated `tasks.json` with Cleanup Task**
```json
{
    "version": "2.0.0",
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: Compile Active File with cl.exe",
            "command": "cl.exe",
            "args": [
                "/Zi",
                "/EHsc",
                "/nologo",
                "/Fe${fileDirname}\\bin\\${fileBasenameNoExtension}.exe",
                "${file}"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$msCompile"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by the debugger."
        },
        {
            "type": "shell",
            "label": "C/C++: Clean Build Artifacts",
            "command": "cmd",
            "args": [
                "/c",
                "del /Q \"${fileDirname}\\*.obj\" && if exist \"${fileDirname}\\bin\" rd /S /Q \"${fileDirname}\\bin\""
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [],
            "group": {
                "kind": "none",
                "isDefault": false
            },
            "detail": "Removes temporary build files (*.obj) and clears the bin folder."
        }
    ]
}
```

### Folder tree
```
MAIN_DIR
│   cpp_jump_starter.bat
│   main.cpp
│   main.obj
│   vc140.pdb
│
├───.vscode
│       settings.json
│       tasks.json
│
└───builds
        main.exe
        main.ilk
        main.pdb
```


### How It Works
- **Build Task (`C/C++: Compile Active File with cl.exe`)**:
  - Compiles the active `.cpp` file into `bin/` folder.
- **Cleanup Task (`C/C++: Clean Build Artifacts`)**:
  - Deletes all `*.obj` files.
  - **Removes the entire `bin/` folder** if it exists.

### How to Use the Cleanup Task
1. **Open the command palette (`Ctrl+Shift+P`)**.
2. Type **"Run Task"** and press **Enter**.
3. Select **"C/C++: Clean Build Artifacts"**.
4. It will remove unnecessary files.